<?phpif (!defined('BASEPATH'))exit('No direct script access allowed');function trata_email($email) {    $email_lido = new stdClass();    $string = $email->getHeader();    $recipients = $email->getRecipients();    preg_match_all('~(\s?(?P<weekday>Mon|Tue|Wed|Thu|Fri|Sat|Sun))[,]?\s?(?P<day>[0-9]{1,2})\s(?P<month>Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?P<year>[0-9]{4})\s(?P<hours>[0-9]{2}):(?P<minutes>[0-9]{2})(:(?P<seconds>[0-9]{2}))?\s(?P<timezone>[\+|\-][0-9]{4})\s?~', $string, $resultado);    if ($resultado[0][0]) {        $email_lido->Data_dat = date('Y-m-d H:i:s', strtotime($resultado[0][0]));    } else {        $email_lido->Data_dat = 'nÃ£o consta no header';    }    $email_lido->Assunto_txf = $email->getSubject();    if ($recipients[0]) {        $email_lido->Acao_txf = $recipients[0]->getAction();        $email_lido->Status_txf = $recipients[0]->getStatus();        $email_lido->Status_texto_txf = trata_codigo($recipients[0]->getStatus());        $email_lido->Email_txf = $recipients[0]->getEmail();        $email_lido->Tipo_bounce_txf = $recipients[0]->getBounceType();        $email_lido->Categoria_bounce_txf = $recipients[0]->getBounceCat();    }//    else {//        $email_lido->Acao_txf = '';//        $email_lido->Status_txf = '';//        $email_lido->Email_txf = '';//        $email_lido->Tipo_bounce_txf = '';//        $email_lido->Categoria_bounce_txf = '';//    }    return $email_lido;}function trata_codigo($codigo) {    switch ($codigo) {        case '5.0.0' :            return "Unknown issue";            break;//5.1.0 	Other address status//        break;//5.1.1 	Bad destination mailbox address//    break;//5.1.2 	Bad destination system address//break;//5.1.3 	Bad destination mailbox address syntax//break;//5.1.4 	Destination mailbox address ambiguous//break;//5.1.5 	Destination mailbox address valid//break;//5.1.6 	Mailbox has moved//break;//5.1.7 	Bad sender's mailbox address syntax//    break;//5.1.8 	Bad sender's system address//break;//5.2.0 	Other or undefined mailbox status////5.2.1 	Mailbox disabled, not accepting messages//        break;        case '5.2.2' :            return "Mailbox full";            break;//5.2.3 	Message length exceeds administrative limit.//        break;//5.2.4 	Mailing list expansion problem//    break;//5.3.0 	Other or undefined mail system status//break;//5.3.1 	Mail system full//break;//5.3.2 	System not accepting network messages//5.3.3 	System not capable of selected features//5.3.4 	Message too big for system//5.4.0 	Other or undefined network or routing status//5.4.1 	No answer from host//5.4.2 	Bad connection//5.4.3 	Routing server failure        case '5.4.4' :            return "Unable to route";            break;//5.4.5 	Network congestion//5.4.6 	Routing loop detected//5.4.7 	Delivery time expired//5.5.0 	Other or undefined protocol status//5.5.1 	Invalid command//5.5.2 	Syntax error//5.5.3 	Too many recipients//5.5.4 	Invalid command arguments//5.5.5 	Wrong protocol version//5.6.0 	Other or undefined media error//5.6.1 	Media not supported//5.6.2 	Conversion required and prohibited//5.6.3 	Conversion required but not supported//5.6.4 	Conversion with loss performed//5.6.5 	Conversion failed//5.7.0 	Other or undefined security status//5.7.1 	Delivery not authorized, message refused//5.7.2 	Mailing list expansion prohibited//5.7.3 	Security conversion required but not possible//5.7.4 	Security features not supported//5.7.5 	Cryptographic failure//5.7.6 	Cryptographic algorithm not supported//5.7.7 	Message integrity failure        default:            return 'desconhecido';            break;    }}